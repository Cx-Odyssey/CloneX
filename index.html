<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CX Odyssey: Rise of the Collectors</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-logo">CX ODYSSEY</div>
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">Initializing Game...</div>
        <div class="loading-progress">
            <div class="loading-progress-bar" id="loadingProgressBar"></div>
        </div>
    </div>

    <div class="game-container">
        <div class="stars" id="starfield"></div>

        <!-- Galaxy Screen -->
        <div class="screen" id="galaxyScreen">
            <div class="header">
                <div class="logo">CX ODYSSEY</div>
                <div class="resources">
                    <div class="resource">âš¡ <span id="energy">100</span></div>
                    <div class="resource">ğŸ’ <span id="shards">0</span></div>
                    <div class="resource">ğŸ† <span id="gp">0</span></div>
                </div>
            </div>
            
            <div class="tg-user-info" id="tgUserInfo">
                <img class="tg-avatar" id="tgAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23FFD700'/%3E%3Ctext x='50' y='65' text-anchor='middle' font-size='40' fill='%23000'%3EğŸ‘¤%3C/text%3E%3C/svg%3E">
                <div>
                    <div id="tgUserName" style="font-weight: 700; font-size: 16px;">Explorer</div>
                    <div style="font-size: 12px; opacity: 0.8;">Level <span id="tgUserLevel">1</span> â€¢ Rank #<span id="userRank">999</span></div>
                </div>
            </div>

            <div class="galaxy-map">
                <div class="planet planet-pyrion" onclick="selectPlanet('Pyrion', 1)" data-planet="pyrion">
                    <div class="planet-overlay"></div>
                    <div class="planet-info">
                        <div class="planet-name">ğŸ”¥ Pyrion</div>
                        <div class="planet-desc">Fire World</div>
                    </div>
                </div>
                <div class="planet planet-aqueos" onclick="selectPlanet('Aqueos', 2)" data-planet="aqueos">
                    <div class="planet-overlay"></div>
                    <div class="planet-info">
                        <div class="planet-name">ğŸŒŠ Aqueos</div>
                        <div class="planet-desc">Ocean World</div>
                    </div>
                </div>
                <div class="planet planet-voidex" onclick="selectPlanet('Voidex', 3)" data-planet="voidex">
                    <div class="planet-overlay"></div>
                    <div class="planet-info">
                        <div class="planet-name">ğŸŒŒ Voidex</div>
                        <div class="planet-desc">Dark Matter</div>
                    </div>
                </div>
                <div class="planet planet-chloros" onclick="selectPlanet('Chloros', 4)" data-planet="chloros">
                    <div class="planet-overlay"></div>
                    <div class="planet-info">
                        <div class="planet-name">ğŸŒ¿ Chloros</div>
                        <div class="planet-desc">Bio World</div>
                    </div>
                </div>
                <div class="planet planet-aurelia" onclick="selectPlanet('Aurelia', 5)" data-planet="aurelia">
                    <div class="planet-overlay"></div>
                    <div class="planet-info">
                        <div class="planet-name">âœ¨ Aurelia</div>
                        <div class="planet-desc">Gold Planet</div>
                    </div>
                </div>
                <div class="planet planet-crimson" onclick="selectPlanet('Crimson', 6)" data-planet="crimson">
                    <div class="planet-overlay"></div>
                    <div class="planet-info">
                        <div class="planet-name">âš”ï¸ Crimson</div>
                        <div class="planet-desc">War Zone</div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-btn" onclick="showScreen('bossScreen')">ğŸ‰ Boss Raid</button>
            </div>
        </div>

        <!-- Mining Screen -->
        <div class="screen" id="miningScreen">
            <div class="header">
                <div class="logo">MINING: <span id="currentPlanet">Planet</span></div>
                <div class="resources">
                    <div class="resource">âš¡ <span id="energyMining">100</span></div>
                    <div class="resource">ğŸ’ <span id="shardsMining">0</span></div>
                </div>
            </div>

            <div class="mining-container">
                <div class="mining-planet" id="miningPlanet" onclick="minePlanet()">
                    <div class="mining-overlay">
                        <div class="mine-text">
                            <div class="mine-icon">â›ï¸</div>
                            <div class="mine-title">TAP TO MINE</div>
                            <div class="mine-reward">+<span id="mineReward">5</span> Shards</div>
                        </div>
                    </div>
                </div>

                <div class="energy-section">
                    <div class="energy-info">Energy: <span id="energyText">100/100</span></div>
                    <div class="energy-bar">
                        <div class="energy-fill" id="energyFill" style="width: 100%"></div>
                    </div>
                </div>

                <div class="mining-actions">
                    <button class="action-btn" onclick="watchAdForEnergy()" id="adBtn">ğŸ“º Ad (+25 Energy)</button>
                    <button class="action-btn" onclick="battleAliens()">âš”ï¸ Battle (+30 GP)</button>
                    <button class="action-btn" onclick="showScreen('galaxyScreen')">ğŸŒŒ Back to Galaxy</button>
                </div>
            </div>
        </div>

        <!-- Boss Screen -->
        <div class="screen" id="bossScreen">
            <div class="header">
                <div class="logo">BOSS RAID</div>
                <div class="resources">
                    <div class="resource">ğŸ† <span id="gpBoss">0</span></div>
                    <div class="resource">âš”ï¸ <span id="damage">0</span></div>
                </div>
            </div>

            <div class="boss-container">
                <h2 class="boss-title">ğŸ‰ COSMIC OVERLORD</h2>
                
                <div class="boss-image" onclick="attackBoss()">ğŸ‘¹</div>

                <div class="boss-health-section">
                    <div class="boss-health-text">Boss Health: <span id="bossHealthText">500/500</span></div>
                    <div class="boss-health">
                        <div class="boss-health-fill" id="bossHealthFill" style="width: 100%"></div>
                    </div>
                </div>

                <div class="boss-actions">
                    <button class="action-btn" onclick="attackBoss()">âš”ï¸ ATTACK!</button>
                    <button class="action-btn" onclick="watchAdForDamage()">ğŸ“º Ad (2x Damage)</button>
                    <button class="action-btn" onclick="showScreen('galaxyScreen')">ğŸŒŒ Back to Galaxy</button>
                </div>

                <div class="player-damage-display">
                    Your Damage: <span id="playerDamage" class="damage-value">0</span>
                </div>
            </div>
        </div>

        <!-- Shop Screen -->
        <div class="screen" id="shopScreen">
            <div class="header">
                <div class="logo">SHOP & UPGRADES</div>
                <div class="resources">
                    <div class="resource">ğŸ† <span id="gpShop">0</span></div>
                    <div class="resource">ğŸ’ <span id="shardsShop">0</span></div>
                </div>
            </div>

            <div class="shop-tabs">
                <button class="shop-tab active" id="upgradesShopTab" onclick="switchShopTab('upgrades')">
                    Upgrades
                </button>
                <button class="shop-tab" id="itemsShopTab" onclick="switchShopTab('items')">
                    Items
                </button>
                <button class="shop-tab premium-tab" id="premiumShopTab" onclick="switchShopTab('premium')">
                    Premium
                </button>
            </div>

            <div id="shopContent">
                <!-- Upgrades Tab (Default) -->
                <div class="shop-grid" id="upgradesShopContent">
                    <div class="shop-item" onclick="buyUpgrade('speed')">
                        <div class="shop-icon">ğŸš€</div>
                        <div class="shop-title">Speed Boost</div>
                        <div class="shop-cost" id="speedCost">50 GP</div>
                        <div class="shop-desc">+20% Mining Speed</div>
                    </div>
                    <div class="shop-item" onclick="buyUpgrade('damage')">
                        <div class="shop-icon">âš”ï¸</div>
                        <div class="shop-title">Damage Boost</div>
                        <div class="shop-cost" id="damageCost">75 GP</div>
                        <div class="shop-desc">+30% Battle Damage</div>
                    </div>
                    <div class="shop-item" onclick="buyUpgrade('energy')">
                        <div class="shop-icon">âš¡</div>
                        <div class="shop-title">Energy Tank</div>
                        <div class="shop-cost" id="energyCost">100 GP</div>
                        <div class="shop-desc">+25 Max Energy</div>
                    </div>
                    <div class="shop-item" onclick="buyUpgrade('multiplier')">
                        <div class="shop-icon">ğŸ’°</div>
                        <div class="shop-title">GP Multiplier</div>
                        <div class="shop-cost" id="multiplierCost">200 GP</div>
                        <div class="shop-desc">+50% GP Gain</div>
                    </div>
                </div>

                <!-- Items Tab -->
                <div class="shop-grid" id="itemsShopContent" style="display: none;">
                    <div class="shop-item" onclick="buyShopItem('energyPotion')">
                        <div class="shop-icon">ğŸ§ª</div>
                        <div class="shop-title">Energy Potion</div>
                        <div class="shop-cost">150 GP</div>
                        <div class="shop-desc">Instant +50 Energy</div>
                    </div>
                    <div class="shop-item" onclick="buyShopItem('bossTicket')">
                        <div class="shop-icon">ğŸ«</div>
                        <div class="shop-title">Boss Ticket</div>
                        <div class="shop-cost">200 GP</div>
                        <div class="shop-desc">+1 Game Ticket</div>
                    </div>
                    <div class="shop-item" onclick="buyShopItem('shardBooster')">
                        <div class="shop-icon">ğŸ’ </div>
                        <div class="shop-title">Shard Booster</div>
                        <div class="shop-cost">300 GP</div>
                        <div class="shop-desc">2x Shards (1 hour)</div>
                    </div>
                    <div class="shop-item" onclick="buyShopItem('gpBooster')">
                        <div class="shop-icon">ğŸ¯</div>
                        <div class="shop-title">GP Booster</div>
                        <div class="shop-cost">400 GP</div>
                        <div class="shop-desc">2x GP (1 hour)</div>
                    </div>
                    <div class="shop-item" onclick="buyShopItem('autoMiner')">
                        <div class="shop-icon">ğŸ¤–</div>
                        <div class="shop-title">Auto Miner</div>
                        <div class="shop-cost">800 GP</div>
                        <div class="shop-desc">Auto mine (2 hours)</div>
                    </div>
                    <div class="shop-item" onclick="buyShopItem('luckyCharm')">
                        <div class="shop-icon">ğŸ€</div>
                        <div class="shop-title">Lucky Charm</div>
                        <div class="shop-cost">500 GP</div>
                        <div class="shop-desc">+50% Drop Rate (1 hour)</div>
                    </div>
                </div>

                <!-- Premium Tab -->
                <div class="shop-grid" id="premiumShopContent" style="display: none;">
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸ‘‘</div>
                        <div class="shop-title">VIP Pass</div>
                        <div class="shop-cost ton-cost">2.5 TON</div>
                        <div class="shop-desc">30 days premium benefits</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸ›¸</div>
                        <div class="shop-title">Legendary Ship</div>
                        <div class="shop-cost ton-cost">5 TON</div>
                        <div class="shop-desc">+100% to all stats</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">âš¡</div>
                        <div class="shop-title">Unlimited Energy</div>
                        <div class="shop-cost ton-cost">1.5 TON</div>
                        <div class="shop-desc">No energy limit (7 days)</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸ’°</div>
                        <div class="shop-title">GP Mega Pack</div>
                        <div class="shop-cost ton-cost">3 TON</div>
                        <div class="shop-desc">Instant 50,000 GP</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸ¨</div>
                        <div class="shop-title">Cosmic Skin Pack</div>
                        <div class="shop-cost ton-cost">4 TON</div>
                        <div class="shop-desc">10 exclusive skins</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸ”¥</div>
                        <div class="shop-title">Double XP Boost</div>
                        <div class="shop-cost ton-cost">2 TON</div>
                        <div class="shop-desc">2x XP forever</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸ</div>
                        <div class="shop-title">Starter Bundle</div>
                        <div class="shop-cost ton-cost">1 TON</div>
                        <div class="shop-desc">Best value package</div>
                    </div>
                    <div class="shop-item premium-item" onclick="showPremiumComingSoon()">
                        <div class="premium-badge">ğŸ’</div>
                        <div class="shop-icon">ğŸŒŸ</div>
                        <div class="shop-title">Ultimate Pack</div>
                        <div class="shop-cost ton-cost">10 TON</div>
                        <div class="shop-desc">Everything unlocked</div>
                    </div>
                </div>
            </div>

            <div class="shop-actions">
                <button class="action-btn" onclick="showScreen('galaxyScreen')">ğŸŒŒ Back to Galaxy</button>
            </div>
        </div>

        <!-- Tasks Screen -->
        <div class="screen" id="tasksScreen">
            <div class="header">
                <div class="logo">TASKS & MISSIONS</div>
                <div class="resources">
                    <div class="resource">âœ… <span id="completedTasks">0</span>/8</div>
                </div>
            </div>

            <div class="balance-section">
                <div class="balance-label">Your balance</div>
                <div class="balance-display">
                    <div class="balance-icon">ğŸ†</div>
                    <div class="balance-amount" id="taskBalanceDisplay">0</div>
                </div>
            </div>

            <div class="task-tabs">
                <button class="task-tab active" id="dailyTasksTab" onclick="switchTaskTab('daily')">
                    Daily Tasks
                </button>
                <button class="task-tab" id="oneTimeTasksTab" onclick="switchTaskTab('onetime')">
                    Main Tasks
                </button>
            </div>

            <div id="taskContent"></div>

            <div class="task-actions">
                <button class="action-btn" onclick="showScreen('galaxyScreen')">ğŸŒŒ Back to Galaxy</button>
            </div>
        </div>

        <!-- Mini-Games Screen -->
        <div class="screen" id="minigamesScreen">
            <div class="header">
                <div class="logo">MINI-GAMES HUB</div>
                <div class="resources">
                    <div class="resource">ğŸ† <span id="gpMinigames">0</span></div>
                    <div class="resource">
                        ğŸ« <span id="gameTickets">3</span>
                        <div class="ticket-cooldown" id="ticketCooldown"></div>
                    </div>
                </div>
            </div>

            <div class="daily-combo-game">
                <h3 class="combo-title">ğŸ”® Daily Combo Code</h3>
                <p class="combo-description">Guess today's secret code!</p>
                <div class="combo-input">
                    <input type="text" class="combo-digit" maxlength="1" id="combo1">
                    <input type="text" class="combo-digit" maxlength="1" id="combo2">
                    <input type="text" class="combo-digit" maxlength="1" id="combo3">
                    <input type="text" class="combo-digit" maxlength="1" id="combo4">
                </div>
                <div class="combo-keypad">
                    <button class="combo-key" onclick="inputComboDigit('1')">1</button>
                    <button class="combo-key" onclick="inputComboDigit('2')">2</button>
                    <button class="combo-key" onclick="inputComboDigit('3')">3</button>
                    <button class="combo-key" onclick="inputComboDigit('4')">4</button>
                    <button class="combo-key" onclick="inputComboDigit('5')">5</button>
                    <button class="combo-key" onclick="inputComboDigit('6')">6</button>
                    <button class="combo-key" onclick="inputComboDigit('7')">7</button>
                    <button class="combo-key" onclick="inputComboDigit('8')">8</button>
                    <button class="combo-key" onclick="inputComboDigit('9')">9</button>
                    <button class="combo-key clear-btn" onclick="clearCombo()">Clear</button>
                    <button class="combo-key" onclick="inputComboDigit('0')">0</button>
                    <button class="combo-key submit-btn" onclick="submitCombo()">Submit</button>
                </div>
                <p class="combo-info">Attempts: <span id="comboAttempts">3</span>/3 | Reward: 100 GP</p>
            </div>

            <div class="minigame-actions">
                <button class="action-btn" onclick="showScreen('galaxyScreen')">ğŸŒŒ Back to Galaxy</button>
            </div>
        </div>

        <!-- Command Center (Profile) Screen -->
        <div class="screen" id="profileScreen">
            <div class="header">
                <div class="logo">COMMAND CENTER</div>
                <div class="resources">
                    <div class="resource">#<span id="profileRank">999</span></div>
                </div>
            </div>

            <div class="balance-section">
                <div class="balance-label">Your balance</div>
                <div class="balance-display">
                    <div class="balance-icon">ğŸ†</div>
                    <div class="balance-amount" id="profileBalanceDisplay">0</div>
                </div>
            </div>

            <div class="profile-tabs">
                <button class="profile-tab active" id="referralTab" onclick="switchProfileTab('referral')">
                    Referral
                </button>
                <button class="profile-tab" id="achievementsTab" onclick="switchProfileTab('achievements')">
                    Achievements
                </button>
                <button class="profile-tab" id="leaderboardTab" onclick="switchProfileTab('leaderboard')">
                    Leaderboard
                </button>
                <button class="profile-tab" id="walletTab" onclick="switchProfileTab('wallet')">
                    Wallet
                </button>
            </div>

            <div id="profileContent"></div>

            <div class="profile-actions">
                <button class="action-btn" onclick="showScreen('galaxyScreen')">ğŸŒŒ Back to Galaxy</button>
            </div>
        </div>

        <!-- Navigation Bar -->
        <div class="nav-bar">
            <button class="nav-btn active" onclick="showScreen('galaxyScreen')">
                <div class="nav-icon">ğŸŒŒ</div>
                <div class="nav-label">Galaxy</div>
            </button>
            <button class="nav-btn" onclick="showScreen('shopScreen')">
                <div class="nav-icon">ğŸ›’</div>
                <div class="nav-label">Shop</div>
            </button>
            <button class="nav-btn" onclick="showScreen('minigamesScreen')">
                <div class="nav-icon">ğŸ®</div>
                <div class="nav-label">Games</div>
            </button>
            <button class="nav-btn" onclick="showScreen('tasksScreen')">
                <div class="nav-icon">ğŸ“‹</div>
                <div class="nav-label">Tasks</div>
            </button>
            <button class="nav-btn" onclick="showScreen('profileScreen')">
                <div class="nav-icon">ğŸ‘¤</div>
                <div class="nav-label">Profile</div>
            </button>
        </div>

        <!-- Modals -->
        <div class="modal" id="adModal">
            <div class="modal-content">
                <button class="close-btn" onclick="closeModal('adModal')">&times;</button>
                <h2 class="modal-title">ğŸ¬ Watch Ad</h2>
                <p class="modal-text">Watch this short video to get your reward!</p>
                <div class="ad-video">ğŸ“º</div>
                <div class="ad-progress-section">
                    <div class="ad-progress-bar">
                        <div id="adProgress" class="ad-progress-fill"></div>
                    </div>
                    <div class="ad-time-text">Ad progress: <span id="adTime">0</span>/5 seconds</div>
                </div>
                <button class="action-btn" onclick="skipAd()" id="skipBtn" style="display: none;">âœ… Claim Reward</button>
            </div>
        </div>

        <div class="modal" id="rewardModal">
            <div class="modal-content">
                <button class="close-btn" onclick="closeModal('rewardModal')">&times;</button>
                <h2 class="modal-title">ğŸ‰ Reward Earned!</h2>
                <div class="reward-icon" id="rewardIcon">ğŸ’</div>
                <div class="reward-text" id="rewardText">+25 GP</div>
                <p class="modal-text">Keep collecting to unlock more rewards!</p>
                <button class="action-btn" onclick="closeModal('rewardModal')">Continue</button>
            </div>
        </div>

        <div class="modal" id="upgradeModal">
            <div class="modal-content">
                <button class="close-btn" onclick="closeModal('upgradeModal')">&times;</button>
                <h2 class="modal-title">ğŸš€ Upgrade Complete!</h2>
                <div class="upgrade-icon" id="upgradeIcon">âš¡</div>
                <div class="upgrade-text" id="upgradeText">Speed boost activated!</div>
                <p class="modal-text">Your ship is now more powerful!</p>
                <button class="action-btn" onclick="closeModal('upgradeModal')">Awesome!</button>
            </div>
        </div>

        <div class="modal" id="premiumComingSoonModal">
            <div class="modal-content premium-modal">
                <button class="close-btn" onclick="closeModal('premiumComingSoonModal')">&times;</button>
                <h2 class="modal-title">ğŸ’ Premium Features</h2>
                <div class="premium-icon">ğŸš€</div>
                <div class="premium-message">
                    <p style="font-size: 18px; color: var(--neon-blue); font-weight: bold; margin-bottom: 15px;">Coming Soon!</p>
                    <p style="font-size: 14px; line-height: 1.6; margin-bottom: 20px;">
                        Premium TON purchases will be available soon.<br>
                        Connect your TON wallet to get notified!
                    </p>
                    <div style="background: rgba(0, 245, 255, 0.1); padding: 15px; border-radius: 12px; margin: 15px 0;">
                        <p style="font-size: 12px; color: rgba(255, 255, 255, 0.8); margin: 0;">
                            ğŸ’¡ Tip: Start earning GP now to unlock exclusive rewards when premium features launch!
                        </p>
                    </div>
                </div>
                <button class="action-btn" onclick="closeModal('premiumComingSoonModal')" style="background: linear-gradient(135deg, var(--neon-blue), #0091EA);">Got it!</button>
            </div>
        </div>
    </div>

    <script src="js/gameState.js"></script>
    <script src="js/backend.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/mining.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/shop.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
